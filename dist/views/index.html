<!DOCTYPE html>
<html lang="en">
<head>
<title>Scanner</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="https://unpkg.com/tabulator-tables@4.1.3/dist/css/tabulator.min.css" rel="stylesheet">
<script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.1.3/dist/js/tabulator.min.js"></script>

<script type="text/javascript">
$(document).ready( function () {
        var interval = "1day";
        $( "#intervalDropDown" ).change(function() {
          interval = $("#intervalDropDown").val();
        });

        $( "#symbolDropdown" ).change(function() {
          var symbol = $("#symbolDropdown").val();
          loadSymbolData(symbol,interval);
        });
       

        $.ajax({
        type: "get",
        url: 'http://localhost:8080/getListOfAllSymbol',success: function(data){
              helpers.buildDropdown(
                  data,
                  $('#symbolDropdown'),
                  'Select an option'
              );

              loadSymbolData("sbin","1day");
          }
        });

        var helpers = {
          buildDropdown: function(result, dropdown, emptyMessage){
              dropdown.html('');
              dropdown.append('<option value="">' + emptyMessage + '</option>');
              if(result != ''){
                  $.each(result, function(k, v) {
                      dropdown.append('<option value="' + v + '">' + v + '</option>');
                  });
              }
          }
        }

        function loadSymbolData(symbolName,interval){
          $.get({
            url: 'http://localhost:8080/loadSymbol/'+symbolName+"/"+interval,
            success: function(dataSet){
                  var table = new Tabulator("#example-table", {
                    data:dataSet,
                    columns:[
                        {title:"timestamp", field:"timestamp"},
                        {title:"open", field:"open"},
                        {title:"close", field:"close"},
                        {title:"high", field:"high"},
                        {title:"cp", field:"cp"},
                        {title:"low", field:"low"},
                        {title:"volume", field:"volume"},
                        {title:"RSI", field:"rsi"},
                        {title:"SMA", field:"sma"}
                    ]
                });
            }
          });  
          }
          
});
</script>
</head>
<body>

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">Scanner</a>
    </div>
    <ul class="nav navbar-nav">
      <li class="active"><a href="#">Home</a></li>
      <li><a href="#login">Login</a></li>
      <li><a href="#signup">SignUp</a></li>
      <li><a href="#contactus">Contact Us</a></li>
    </ul>
  </div>
</nav>
  
<div class="container">
  <div class="row">

      <div class="col-sm">
          <select  id="symbolDropdown" type="button" class="btn-group dropup"></select>
        </div>
        <div class="col-sm">
            <select id="intervalDropDown" class="btn-group dropup">
                <option value="1MINUTE">1MINUTE</option>
                <option value="5MINUTE">5MINUTE</option>
                <option value="10MINUTE">10MINUTE</option>
                <option value="30MINUTE">30MINUTE</option>
                <option value="60MINUTE">60MINUTE</option>
                <option value="1DAY">1DAY</option>
                <option value="1WEEK">1WEEK</option>
                <option value="1MONTH">1MONTH</option>
              </select>
        </div>
        <div class="col-sm">
          
        </div>
  </div>
  <br></br>
  <div class="row">
      <div id="example-table"></div>
  </div>  
</div>
</body>
</html>